/**
 * Created by user on 2017/7/14/014.
 */
'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
function _uf_fixsize2(who, area, force, scrollsize) {
    let _elem = $(who);
    let _ok;
    if ($.isPlainObject(area) && $.isNumeric(area.width)) {
        area = $('<div/>')
            .width(area.width)
            .height(area.height !== undefined ? area.height : area.width);
    }
    else if ($.isArray(area) && $.isNumeric(area[0])) {
        area = $('<div/>')
            .width(area[0])
            .height(area[1] !== undefined ? area[1] : area[0]);
    }
    if (area === true || area == who || area == _elem) {
        scrollsize = null;
        _ok = true;
    }
    else if (area) {
        _ok = area;
    }
    else {
        _ok = window;
    }
    if (!scrollsize || _ok === true || (scrollsize.width === undefined && scrollsize.height === undefined) || (!scrollsize.width && !scrollsize.height)) {
        scrollsize = null;
    }
    else {
        if (scrollsize == 'auto') {
            scrollsize.width = 'auto';
            scrollsize.height = 'auto';
        }
        scrollsize.width = scrollsize.width || 0;
        scrollsize.height = scrollsize.height || 0;
    }
    _elem.each(function () {
        let _this = $(this);
        let _area = $(_ok === true ? this : _ok);
        let _w = _this[0].naturalWidth;
        let _h = _this[0].naturalHeight;
        if (!_w || !_h) {
            _w = _this.width();
            _h = _this.height();
        }
        let _w2 = _area.width();
        let _h2 = _area.height();
        if (scrollsize) {
            _w2 = scrollsize.width == 'auto' ? _area.innerWidth() : _w2 - scrollsize.width;
            _h2 = scrollsize.height == 'auto' ? _area.innerHeight() : _h2 - scrollsize.height;
        }
        let _w3 = _w;
        let _h3 = _h;
        if (_w > _w2) {
            _w3 = _w2;
            _h3 = _h * (_w2 / _w);
            if (_h3 > _h2) {
                _w3 = _w3 * (_h2 / _h3);
                _h3 = _h2;
            }
        }
        else if (force > 1) {
            let scale = calc_scale(_w, _h);
            _w3 = _w3 * scale;
            _h3 = _h2;
            //console.log(force, scale, [_w, _h], [_w3, _h3]);
        }
        else if (force || (_h > _h2)) {
            _w3 = _w * (_h2 / _h);
            _h3 = _h2;
            if (_w3 > _w2) {
                _w3 = _w2;
                _h3 = _h * (_w2 / _w);
            }
        }
        else {
        }
        _this.height(_h3).width(_w3);
        _this.attr({
            'data-naturalHeight': _h,
            'data-naturalWidth': _w,
            'data-height': _h3,
            'data-width': _w3,
        });
    });
    return _elem;
}
exports._uf_fixsize2 = _uf_fixsize2;
exports.default = _uf_fixsize2;
function calc_scale(w, h) {
    return w / h;
}
exports.calc_scale = calc_scale;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2l6ZS5qcyIsInNvdXJjZVJvb3QiOiJEOi9Vc2Vycy9Eb2N1bWVudHMvVGhlIFByb2plY3QvZ21fc2NyaXB0c19yZXBvL3V4LXR3ZWFrLXNjLyIsInNvdXJjZXMiOlsibGliL2RvbS9pbWcvc2l6ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7R0FFRztBQUVILFlBQVksQ0FBQzs7QUFFYixzQkFBNkIsR0FBRyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsVUFBVTtJQUV4RCxJQUFJLEtBQUssR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7SUFFbkIsSUFBSSxHQUFHLENBQUM7SUFFUixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQ3JELENBQUM7UUFDQSxJQUFJLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQzthQUNoQixLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQzthQUNqQixNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sS0FBSyxTQUFTLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQzdEO0lBQ0YsQ0FBQztJQUNELElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FDakQsQ0FBQztRQUNBLElBQUksR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDO2FBQ2hCLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDZCxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLFNBQVMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQ2xEO0lBQ0Ys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M0hELG9DQTJIQztBQUVELGtCQUFlLFlBQVksQ0FBQztBQUU1QixvQkFBMkIsQ0FBUyxFQUFFLENBQVM7SUFFOUMsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDZCxDQUFDO0FBSEQsZ0NBR0MiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkgdXNlciBvbiAyMDE3LzcvMTQvMDE0LlxuICovXG5cbid1c2Ugc3RyaWN0JztcblxuZXhwb3J0IGZ1bmN0aW9uIF91Zl9maXhzaXplMih3aG8sIGFyZWEsIGZvcmNlLCBzY3JvbGxzaXplKVxue1xuXHRsZXQgX2VsZW0gPSAkKHdobyk7XG5cblx0bGV0IF9vaztcblxuXHRpZiAoJC5pc1BsYWluT2JqZWN0KGFyZWEpICYmICQuaXNOdW1lcmljKGFyZWEud2lkdGgpKVxuXHR7XG5cdFx0YXJlYSA9ICQoJzxkaXYvPicpXG5cdFx0XHQud2lkdGgoYXJlYS53aWR0aClcblx0XHRcdC5oZWlnaHQoYXJlYS5oZWlnaHQgIT09IHVuZGVmaW5lZCA/IGFyZWEuaGVpZ2h0IDogYXJlYS53aWR0aClcblx0XHQ7XG5cdH1cblx0ZWxzZSBpZiAoJC5pc0FycmF5KGFyZWEpICYmICQuaXNOdW1lcmljKGFyZWFbMF0pKVxuXHR7XG5cdFx0YXJlYSA9ICQoJzxkaXYvPicpXG5cdFx0XHQud2lkdGgoYXJlYVswXSlcblx0XHRcdC5oZWlnaHQoYXJlYVsxXSAhPT0gdW5kZWZpbmVkID8gYXJlYVsxXSA6IGFyZWFbMF0pXG5cdFx0O1xuXHR9XG5cblx0aWYgKGFyZWEgPT09IHRydWUgfHwgYXJlYSA9PSB3aG8gfHwgYXJlYSA9PSBfZWxlbSlcblx0e1xuXHRcdHNjcm9sbHNpemUgPSBudWxsO1xuXHRcdF9vayA9IHRydWU7XG5cdH1cblx0ZWxzZSBpZiAoYXJlYSlcblx0e1xuXHRcdF9vayA9IGFyZWE7XG5cdH1cblx0ZWxzZVxuXHR7XG5cdFx0X29rID0gd2luZG93O1xuXHR9XG5cblx0aWYgKCFzY3JvbGxzaXplIHx8IF9vayA9PT0gdHJ1ZSB8fCAoc2Nyb2xsc2l6ZS53aWR0aCA9PT0gdW5kZWZpbmVkICYmIHNjcm9sbHNpemUuaGVpZ2h0ID09PSB1bmRlZmluZWQpIHx8ICghc2Nyb2xsc2l6ZS53aWR0aCAmJiAhc2Nyb2xsc2l6ZS5oZWlnaHQpKVxuXHR7XG5cdFx0c2Nyb2xsc2l6ZSA9IG51bGw7XG5cdH1cblx0ZWxzZVxuXHR7XG5cdFx0aWYgKHNjcm9sbHNpemUgPT0gJ2F1dG8nKVxuXHRcdHtcblx0XHRcdHNjcm9sbHNpemUud2lkdGggPSAnYXV0byc7XG5cdFx0XHRzY3JvbGxzaXplLmhlaWdodCA9ICdhdXRvJztcblx0XHR9XG5cblx0XHRzY3JvbGxzaXplLndpZHRoID0gc2Nyb2xsc2l6ZS53aWR0aCB8fCAwO1xuXHRcdHNjcm9sbHNpemUuaGVpZ2h0ID0gc2Nyb2xsc2l6ZS5oZWlnaHQgfHwgMDtcblx0fVxuXG5cdF9lbGVtLmVhY2goZnVuY3Rpb24oKXtcblx0XHRsZXQgX3RoaXMgPSAkKHRoaXMpO1xuXHRcdGxldCBfYXJlYSA9ICQoX29rID09PSB0cnVlID8gdGhpcyA6IF9vayk7XG5cblx0XHRsZXQgX3cgPSBfdGhpc1swXS5uYXR1cmFsV2lkdGg7XG5cdFx0bGV0IF9oID0gX3RoaXNbMF0ubmF0dXJhbEhlaWdodDtcblxuXHRcdGlmICghX3cgfHwgIV9oKVxuXHRcdHtcblx0XHRcdF93ID0gX3RoaXMud2lkdGgoKTtcblx0XHRcdF9oID0gX3RoaXMuaGVpZ2h0KCk7XG5cdFx0fVxuXG5cdFx0bGV0IF93MiA9IF9hcmVhLndpZHRoKCk7XG5cdFx0bGV0IF9oMiA9IF9hcmVhLmhlaWdodCgpO1xuXG5cdFx0aWYgKHNjcm9sbHNpemUpXG5cdFx0e1xuXHRcdFx0X3cyID0gc2Nyb2xsc2l6ZS53aWR0aCA9PSAnYXV0bycgPyBfYXJlYS5pbm5lcldpZHRoKCkgOiBfdzIgLSBzY3JvbGxzaXplLndpZHRoO1xuXHRcdFx0X2gyID0gc2Nyb2xsc2l6ZS5oZWlnaHQgPT0gJ2F1dG8nID8gX2FyZWEuaW5uZXJIZWlnaHQoKSA6IF9oMiAtIHNjcm9sbHNpemUuaGVpZ2h0O1xuXHRcdH1cblxuXHRcdGxldCBfdzMgPSBfdztcblx0XHRsZXQgX2gzID0gX2g7XG5cblx0XHRpZiAoX3cgPiBfdzIpXG5cdFx0e1xuXHRcdFx0X3czID0gX3cyO1xuXHRcdFx0X2gzID0gX2ggKiAoX3cyIC8gX3cpO1xuXG5cdFx0XHRpZiAoX2gzID4gX2gyKVxuXHRcdFx0e1xuXHRcdFx0XHRfdzMgPSBfdzMgKiAoX2gyIC8gX2gzKTtcblx0XHRcdFx0X2gzID0gX2gyO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRlbHNlIGlmIChmb3JjZSA+IDEpXG5cdFx0e1xuXHRcdFx0bGV0IHNjYWxlID0gY2FsY19zY2FsZShfdywgX2gpO1xuXG5cdFx0XHRfdzMgPSBfdzMgKiBzY2FsZTtcblx0XHRcdF9oMyA9IF9oMjtcblxuXHRcdFx0Ly9jb25zb2xlLmxvZyhmb3JjZSwgc2NhbGUsIFtfdywgX2hdLCBbX3czLCBfaDNdKTtcblx0XHR9XG5cdFx0ZWxzZSBpZiAoZm9yY2UgfHwgKF9oID4gX2gyKSlcblx0XHR7XG5cdFx0XHRfdzMgPSBfdyAqIChfaDIgLyBfaCk7XG5cdFx0XHRfaDMgPSBfaDI7XG5cblx0XHRcdGlmIChfdzMgPiBfdzIpXG5cdFx0XHR7XG5cdFx0XHRcdF93MyA9IF93Mjtcblx0XHRcdFx0X2gzID0gX2ggKiAoX3cyIC8gX3cpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdH1cblxuXHRcdF90aGlzLmhlaWdodChfaDMpLndpZHRoKF93Myk7XG5cblx0XHRfdGhpcy5hdHRyKHtcblx0XHRcdCdkYXRhLW5hdHVyYWxIZWlnaHQnOiBfaCxcblx0XHRcdCdkYXRhLW5hdHVyYWxXaWR0aCc6IF93LFxuXG5cdFx0XHQnZGF0YS1oZWlnaHQnOiBfaDMsXG5cdFx0XHQnZGF0YS13aWR0aCc6IF93Myxcblx0XHR9KTtcblx0fSk7XG5cblx0cmV0dXJuIF9lbGVtO1xufVxuXG5leHBvcnQgZGVmYXVsdCBfdWZfZml4c2l6ZTI7XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjX3NjYWxlKHc6IG51bWJlciwgaDogbnVtYmVyKVxue1xuXHRyZXR1cm4gdyAvIGg7XG59XG4iXX0=